### **Phishing:**
Phishing is an attempt to steal sensitive information from people by using social engineering techniques over various communication channels such emails, SMS, phone calls and the internet.

### **Goals:**
- Impersonation: posing as a legitimate organization or individuals.
- Stealing sensitive information: password, credit card number.
- Deliver and install malware: via attachments or URLS.
- Exploiting humans: preys on emotions, human psychology.

### **How Does Phishing Work?**
1. Authority: Spoofing executives, managers, IT staffs.
2. Trust: Spoofing customers, banks, partners.
3. Intimidation: Instill a sense of fear of consequences.
4. Social proof: Validate legitimacy through consensus.
5. Urgency: Act NOW!
6. Scarcity: Instill a fear of missing out.
7. Familiarity: Establish credibility through recognition.

### **Phishing Case Studies:**
Phishing Case Studies:
- https://abnormalsecurity.com/blog/colonial-pipeline-attack-phishing-email-likely-the-culprit
- https://www.secureworld.io/industry-news/hedge-fund-closes-after-bec-cyber-attac
- https://krebsonsecurity.com/2015/08/tech-firm-ubiquiti-suffers-46m-cyberheist/
- https://en.wikipedia.org/wiki/2015_Ukraine_power_grid_hack

# Email Fundamentals:
1. Email Headers: Lines of metadata attached to an email and contain many useful strings of information for analysts, and investigators.
2. Email Body: The main content of the email.
3. Email Addresses: Unique address assigned to individual to send and receive emails.
4. Email Protocols: Roles that governs how emails are sent.
   - SMPT Simple Mail Transfer Protocol (25): Used to send outgoing mails.
   - POP3 Post Office Protocol version 3 (110): Used forreceiving emails.
   - IMAP (143): Synchronisation of emails.
5. Mail Agent:
   - Mail Transfer Agent (MTA): Route and transfer email message across email server.
   - Mail User Agent (MUA): Compose, send, receive, and manage emails. e.g. Gmail, Outlook, Yahoo, Thunderbird,etc.
   - Mail Delivery Agent (MDA): Accepting incoming email messages from MTAs.
   - Mail Submission Agent (MSA)
   - Mail Retrieval Agent (MRA)
  
# Phishing Analysis Configuration
Thunderbird installation:
`sudo apt install thunderbird`

Sublime Installation:
Link: https://www.sublimetext.com/
Commands: https://www.sublimetext.com/docs/linux_repositories.html

Install the GPG key:

`wget -qO - https://download.sublimetext.com/sublimehq-pub.gpg | gpg --dearmor | sudo tee /etc/apt/trusted.gpg.d/sublimehq-archive.gpg > /dev/null`

Select the channel to use:

`echo "deb https://download.sublimetext.com/ apt/stable/" | sudo tee /etc/apt/sources.list.d/sublime-text.list`

Update apt sources and install Sublime Text:

`sudo apt-get update`
`sudo apt-get install sublime-text`

# Phishing Attack Types
1. Information Gathering: Collect data through reconnaissance, verify existing accounting, craft credible phishes.
2. Credential Harvesting: Obtain login credentials from victims, fake login pages, and deceptive URLs.
3. Malware Delivery: Malicious attachments or links.
4. Spear phishing: Targeted specific individuals or organisations.
5. Whaling: Targeting high-profile individuals (CEO, Executives)
6. Vishing: Voice phising.
7. Smishing: SMS phishing.
8. Quishing: QR code phishing.
9. Business Email Compromise (BEC): Compromising legitimate email accounts, unathorised wire transfers, etc.
10. Spam: Unsolicited and unwanted emails.

# Phishing Attack Techniques
1. Pretexting: Fabricating a backstory, manipulation under false pretense.
2. Spoofing and Impersonation: Email address and domain faking.
3. URL Manipulation: URL shortrning, subdomain spoofing, homograph attack, typosquating.
4. Encoding: Obfuscate and evade detection, base64, URL encoding, and HTML encoding.
5. Attachment: Download and execute.
6. Abuse of Legitimate Services: Google Drive, Dropbox, etc.
7. Pharming: Two-step technique, malware-base pharming, DNS server poisoning.

References:
- https://bitly.com
- https://unshorten.it
- https://www.irongeek.com/homoglyph-attack-generator.php
- https://github.com/elceef/dnstwist
- https://dnstwist.it/
- https://dnstwister.report/
- https://phishtank.org/

# Email Analysis Methodology
1. Initial Triage: Quickly assess and prioritise.
2. Header and Sender Examination:
   - Investigate MTAs, addresses, IPs,etc.
   - Identify the true origin and check authenticity.
3. Content Examination:
   - Analyse email content for language, formatting, etc.
   - Look for social engineering red flags.
4. Web and URL Examination:
   - Collect web artifacts.
   - Utilise tools to inspect URLs and domains.
5. Attachment Examination:
   - Securely extract and analyse attachments.
   - Checking file reputation and sanboxing.
6. Contectual Examination:
   - Consider broader context, or current incidents.
   - Look forpatterns and assess scope.
7. Defense Measure:
   - Take reactive defense action (if needed)
   - Take proactive defense actions.
   - Communicate with users and stakeholders.
8. Documentaton and Reporting:
   - Maintain records of findigs, verdicts, and actions taken through detailed report.
   - Close out alerts and tickets.

# Email Header and Sender Analysis
References:
- https://packagecontrol.io/packages/Email%20Header
- https://github.com/13Cubed/EmailHeader
- https://www.iana.org/assignments/message-headers/message-headers.xhtml
- https://whois.domaintools.com/
- https://mha.azurewebsites.net/
- https://github.com/microsoft/MHA
- https://mxtoolbox.com/EmailHeaders.aspx

# Email Authentication Methods
1. Sender Policy Framework (SPF): A mechanism that allows domain owners to specify which mail server are authorized to send emails on behalf of their domain.

Checking for SPF records for domain manually:

`nslookup -type=txt shodan.io | grep -i spf`
or

`dig TXT shodan.io | grep -i spf`

2. DomainKeys Identified Mail (DKIM): An email authentication method that helps prevent email spoofing by allowing a sending domain to digitally sign outbound emails.

Online tool: https://mxtoolbox.com/dkim.aspx

# Email Content Analysis
References:
- https://gchq.github.io/CyberChef/

# Email URL Analysis
References:
- https://gchq.github.io/CyberChef/
- https://github.com/MalwareCube/Email-IOC-Extractor
- https://phishtank.org/
- https://www.url2png.com/
- https://urlscan.io/
- https://www.virustotal.com/gui/home/upload
- https://www.urlvoid.com/
- https://www.wannabrowser.net/
- https://unshorten.it/
- https://urlhaus.abuse.ch/
- https://transparencyreport.google.com/safe-browsing/search
- https://www.joesandbox.com/

#   Email Attachment Analysis
References:
- https://github.com/DidierStevens/DidierStevensSuite/blob/master/emldump.py
- https://github.com/MalwareCube/Email-IOC-Extractor
- https://www.virustotal.com/gui/home/upload
- https://talosintelligence.com/
